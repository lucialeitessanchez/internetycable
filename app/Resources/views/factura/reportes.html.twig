{% extends 'base.html.twig' %}

{% block body %}

<link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />

<div class="container-fluid">
<div class="row">
    <br>
<div class="topnav bg-body-tertiary">
  <a href="{{ path('factura_index') }}">Factura</a>
  <a href="{{ path('factura_new') }}">Nueva factura</a>
  <a href="{{ path('prueba_homepage') }}">Menu Principal</a>
   <a href="{{ path('expediente_index') }}">Menú Expediente</a>
  <a href="{{ path('factura_impagas') }}">Facturas Impagas</a>
 <a class="active"  href="{{ path('reportes') }}">Reporte servicios </a>
    <a href="{{ path('factura_impagas') }}">Imprimir reporte</a>
 <form class="d-flex" role="search"><input id="buscar" type="search" class="form-control me-2" placeholder="Escribir mes a filtrar" /> </form>

</div>


<table id="tabla" class="table table-sm  table-hover text-center text-dark">
			<thead class="table-tr-bg" style="position: sticky; top: 0; z-index: 1; background: #957fc9" scope="col">
            <tr>
                <th>Num.Referencia</th>
                <th>Tipo servicio</th>
                <th>Ubicación</th>
                <th>Factura</th>
                <th>Expediente</th>
                <th>Mes</th>
            </tr>
        </thead>
        <tbody>

        {% for factura in facturas %}
            {% for service in factura.service  %}
            {% if service.estado %}
                    <tr>
                        <td>{{ service.referencia }}</td>
                        <td>{{ service.tipo }}</td>
                        <td>{{ service.direccion }}</td>
                    {% endif %}
                    {% endfor %}
                <td>{{factura.numFactura}}</td>
                {% if factura.expediente|first == 1  %}
                <td>00{{ factura.expediente }}</td>
                {% else %}
                <td>0{{ factura.expediente }}</td>
                {% endif %}
                <td>{% for expediente in expedientes %}
                {% if factura.expediente == expediente %}
                {% if expediente.fechaInicioGestion %}
                {{ expediente.fechaInicioGestion|localizeddate('none', 'none', 'es', 'America/Argentina/Jujuy', 'MMMM Y')}}
            {% endif %}   
                {% endif %} 
                {% endfor %}
                </td>

                
            </tr>
            
        {% endfor %}
        </tbody>
    </table>
    </div>
    </div>
    <script>
            var busqueda = document.getElementById('buscar');
            var table = document.getElementById("tabla").tBodies[0];

                buscaTabla = function(){
                texto = busqueda.value.toLowerCase();
                var r=0;
                while(row = table.rows[r++])
                {
                    if ( row.innerText.toLowerCase().indexOf(texto) !== -1 )
                    row.style.display = null;
                    else
                    row.style.display = 'none';
                }
                }

                busqueda.addEventListener('keyup', buscaTabla);
    </script>
{% endblock %}

